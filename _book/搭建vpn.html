
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>搭建vpn · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="服务器安装.html" />
    
    
    <link rel="prev" href="yapi教程.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="SUMMARY.html">
            
                <a href="SUMMARY.html">
            
                    
                    索引
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="Centos7.6.html">
            
                <a href="Centos7.6.html">
            
                    
                    Centos7.6
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="docker-linux.html">
            
                <a href="docker-linux.html">
            
                    
                    docker(linux)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="docker安装-windows.html">
            
                <a href="docker安装-windows.html">
            
                    
                    docker安装(windows)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="dumps&loads.html">
            
                <a href="dumps&loads.html">
            
                    
                    dumps&loads
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="english.html">
            
                <a href="english.html">
            
                    
                    english
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="flask接口.html">
            
                <a href="flask接口.html">
            
                    
                    flask接口
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="git使用.html">
            
                <a href="git使用.html">
            
                    
                    git使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="MySQL操作.html">
            
                <a href="MySQL操作.html">
            
                    
                    MySQL操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.11" data-path="numpy学习.html">
            
                <a href="numpy学习.html">
            
                    
                    numpy学习
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.12" data-path="pip相关.html">
            
                <a href="pip相关.html">
            
                    
                    pip相关
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.13" data-path="python源码.html">
            
                <a href="python源码.html">
            
                    
                    python源码
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.14" data-path="selenium代理.html">
            
                <a href="selenium代理.html">
            
                    
                    selenium代理
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.15" data-path="svn使用.html">
            
                <a href="svn使用.html">
            
                    
                    svn使用
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.16" data-path="vim操作.html">
            
                <a href="vim操作.html">
            
                    
                    vim操作
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.17" data-path="vim的安装配置.html">
            
                <a href="vim的安装配置.html">
            
                    
                    vim的安装配置
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.18" data-path="yapi教程.html">
            
                <a href="yapi教程.html">
            
                    
                    yapi教程
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.19" data-path="搭建vpn.html">
            
                <a href="搭建vpn.html">
            
                    
                    搭建vpn
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.20" data-path="服务器安装.html">
            
                <a href="服务器安装.html">
            
                    
                    服务器安装
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.21" data-path="正则表达式.html">
            
                <a href="正则表达式.html">
            
                    
                    正则表达式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.22" data-path="记录一次搭建ftp服务器.html">
            
                <a href="记录一次搭建ftp服务器.html">
            
                    
                    记录一次搭建ftp服务器
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >搭建vpn</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h3 id="&#x51C6;&#x5907;&#x5DE5;&#x4F5C;">&#x51C6;&#x5907;&#x5DE5;&#x4F5C;</h3>
<h4 id="&#x66F4;&#x65B0;cent-os&#x5E76;&#x542F;&#x7528;epel&#x5B58;&#x50A8;&#x5E93;">&#x66F4;&#x65B0;cent os&#x5E76;&#x542F;&#x7528;EPEL&#x5B58;&#x50A8;&#x5E93;</h4>
<pre><code>sudo yum update -y
yum install epel-release
</code></pre><h3 id="&#x5B89;&#x88C5;openvpn">&#x5B89;&#x88C5;openvpn</h3>
<pre><code>yum install -y openvpn easy-rsa
</code></pre><h4 id="&#x590D;&#x5236;&#x6587;&#x4EF6;">&#x590D;&#x5236;&#x6587;&#x4EF6;</h4>
<pre><code class="lang-shell">[root@localhost ~]# cp -r /usr/share/easy-rsa/ /etc/openvpn/easy-rsa    
[root@localhost ~]# cd /etc/openvpn/easy-rsa/
[root@localhost easy-rsa]# \rm 3 3.0
[root@localhost easy-rsa]# cd 3.0.7/
[root@localhost 3.0.7]# find / -type f -name &quot;vars.example&quot; | xargs -i cp {} . &amp;&amp; mv vars.example vars        # &#x67E5;&#x627E; &quot;vars.example&quot; &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x628A;&#x4ED6;&#x590D;&#x5236;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x91CD;&#x547D;&#x540D;&#x4E3A;vars
</code></pre>
<blockquote>
<p>xargs &#x4E0E; <strong>&#x7BA1;&#x9053;</strong> &#x914D;&#x5408;&#x4F7F;&#x7528;&#xFF0C;&#x5C06; find &#x7684;&#x7ED3;&#x679C;&#x4F5C;&#x4E3A;&#x53C2;&#x6570;&#xFF0C; &#x4EE5; {} &#x8868;&#x793A;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x3002; <code>cp xx .</code> &#x8868;&#x793A;&#x590D;&#x5236;&#x5230;&#x5F53;&#x524D;&#x76EE;&#x5F55;&#x3002; &amp;&amp; &#xFF08;&#x903B;&#x8F91;&#x4E0E;&#xFF09;&#x8FDE;&#x63A5;&#x547D;&#x4EE4;&#xFF0C;&#x53EA;&#x6709;&#x5728;&#x524D;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x6210;&#x529F;&#x540E;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x624D;&#x80FD;&#x6267;&#x884C;</p>
<ul>
<li><p>&#x7528;&#x201C;&#xFF1B;&#x201D;&#x8FDE;&#x63A5;&#x547D;&#x4EE4;&#xFF0C;&#x4E0D;&#x4FDD;&#x8BC1;&#x547D;&#x4EE4;&#x5168;&#x90E8;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x5373;&#x4F7F;&#x524D;&#x8005;&#x6267;&#x884C;&#x5931;&#x8D25;&#xFF0C;&#x540E;&#x8005;&#x4ECD;&#x7136;&#x6267;&#x884C;&#x3002;</p>
</li>
<li><p>&#x7528;&#x201C;||&#x201D;&#xFF08;&#x903B;&#x8F91;&#x6216;&#xFF09;&#x8FDE;&#x63A5;&#x547D;&#x4EE4;&#xFF0C;&#x5982;&#x679C;&#x524D;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x6210;&#x529F;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x5C31;&#x4E0D;&#x80FD;&#x6267;&#x884C;&#x4E86;&#xFF1B;&#x5982;&#x679C;&#x524D;&#x9762;&#x7684;&#x547D;&#x4EE4;&#x6267;&#x884C;&#x4E0D;&#x6210;&#x529F;&#xFF0C;&#x624D;&#x4F1A;&#x6267;&#x884C;&#x540E;&#x9762;&#x7684;&#x547D;&#x4EE4;&#xFF0C;&#x4E24;&#x8005;&#xFF08;&#x591A;&#x8005;&#xFF09;&#x4E2D;&#x5982;&#x679C;&#x6709;&#x4E00;&#x6761;&#x80FD;&#x591F;&#x6B63;&#x5E38;&#x6267;&#x884C;&#xFF0C;&#x5176;&#x4ED6;&#x7684;&#x5219;&#x4E0D;&#x6267;&#x884C;&#x3002;</p>
</li>
</ul>
</blockquote>
<h3 id="&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;">&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;</h3>
<h4 id="&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;pki&#x548C;ca">&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x65B0;&#x7684;PKI&#x548C;CA</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# pwd
/etc/openvpn/easy-rsa/3.0.7
[root@localhost 3.0.7]# ./easyrsa init-pki  # &#x521B;&#x5EFA;&#x7A7A;&#x7684;pki

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars

init-pki complete; you may now create a CA or requests.
Your newly created PKI dir is: /etc/openvpn/easy-rsa/3.0.7/pki


[root@localhost 3.0.7]# ./easyrsa build-ca nopass # &#x521B;&#x5EFA;&#x65B0;&#x7684;CA&#xFF0C;&#x4E0D;&#x4F7F;&#x7528;&#x5BC6;&#x7801;

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017
Generating RSA private key, 2048 bit long modulus
......................................................................+++
................................................................................+++
e is 65537 (0x10001)
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &apos;.&apos;, the field will be left blank.
-----
Common Name (eg: your user, host, or server name) [Easy-RSA CA]: # &#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x56DE;&#x8F66;

CA creation complete and you may now import and sign cert requests.
Your new CA certificate file for publishing is at:
/etc/openvpn/easy-rsa/3.0.7/pki/ca.crt
</code></pre>
<h4 id="&#x521B;&#x5EFA;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;">&#x521B;&#x5EFA;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# ./easyrsa gen-req server nopass

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017
Generating a 2048 bit RSA private key
.......................................................................................................................+++
................................+++
writing new private key to &apos;/etc/openvpn/easy-rsa/3.0.7/pki/easy-rsa-17863.v2n44e/tmp.Q5twYb&apos;
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &apos;.&apos;, the field will be left blank.
-----
Common Name (eg: your user, host, or server name) [server]: # &#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x56DE;&#x8F66;

Keypair and certificate request completed. Your files are:
req: /etc/openvpn/easy-rsa/3.0.7/pki/reqs/server.req
key: /etc/openvpn/easy-rsa/3.0.7/pki/private/server.key
</code></pre>
<h4 id="&#x7B7E;&#x7EA6;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;">&#x7B7E;&#x7EA6;&#x670D;&#x52A1;&#x7AEF;&#x8BC1;&#x4E66;</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# ./easyrsa sign server server

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017


You are about to sign the following certificate.
Please check over the details shown below for accuracy. Note that this request
has not been cryptographically verified. Please be sure it came from a trusted
source or that you have verified the request checksum with the sender.

Request subject, to be signed as a server certificate for 825 days:

subject=
    commonName                = server


Type the word &apos;yes&apos; to continue, or any other input to abort.
  Confirm request details: yes    # &#x8FD9;&#x91CC;&#x8F93;&#x5165;yes
Using configuration from /etc/openvpn/easy-rsa/3.0.7/pki/easy-rsa-18428.6zfZuc/tmp.lr3YlN
Check that the request matches the signature
Signature ok
The Subject&apos;s Distinguished Name is as follows
commonName            :ASN.1 12:&apos;server&apos;
Certificate is to be certified until Aug 31 07:29:15 2022 GMT (825 days)

Write out database with 1 new entries
Data Base Updated

Certificate created at: /etc/openvpn/easy-rsa/3.0.7/pki/issued/server.crt
</code></pre>
<h4 id="&#x521B;&#x5EFA;diffie-hellman">&#x521B;&#x5EFA;Diffie-Hellman</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# ./easyrsa gen-dh
Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017
Generating DH parameters, 2048 bit long safe prime, generator 2
This is going to take a long time

............................................................
DH parameters of size 2048 created at /etc/openvpn/easy-rsa/3.0.7/pki/dh.pem
</code></pre>
<h3 id="&#x521B;&#x5EFA;&#x5BA2;&#x6237;&#x7AEF;&#x8BC1;&#x4E66;">&#x521B;&#x5EFA;&#x5BA2;&#x6237;&#x7AEF;&#x8BC1;&#x4E66;</h3>
<h4 id="&#x590D;&#x5236;&#x6587;&#x4EF6;">&#x590D;&#x5236;&#x6587;&#x4EF6;</h4>
<pre><code class="lang-shell">[root@localhost ~]# cp -r /usr/share/easy-rsa/ /etc/openvpn/client/easy-rsa
[root@localhost ~]# cd /etc/openvpn/client/easy-rsa/
[root@localhost easy-rsa]# \rm 3 3.0 
[root@localhost easy-rsa]# cd 3.0.7/
[root@localhost 3.0.7]# find / -type f -name &quot;vars.example&quot; | xargs -i cp {} . &amp;&amp; mv vars.example vars
</code></pre>
<h4 id="&#x751F;&#x6210;&#x8BC1;&#x4E66;">&#x751F;&#x6210;&#x8BC1;&#x4E66;</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# pwd
/etc/openvpn/client/easy-rsa/3.0.7
[root@localhost 3.0.7]# ./easyrsa init-pki #&#x521B;&#x5EFA;&#x65B0;&#x7684;pki

Note: using Easy-RSA configuration from: /etc/openvpn/client/easy-rsa/3.0.7/vars

init-pki complete; you may now create a CA or requests.
Your newly created PKI dir is: /etc/openvpn/client/easy-rsa/3.0.7/pki

[root@localhost 3.0.7]# ./easyrsa gen-req test nopass  #&#x5BA2;&#x6237;&#x8BC1;&#x4E66;&#x540D;&#x4E3A;test&#xFF0C;&#x6728;&#x6709;&#x5BC6;&#x7801;

Note: using Easy-RSA configuration from: /etc/openvpn/client/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017
Generating a 2048 bit RSA private key
....................................................+++
............+++
writing new private key to &apos;/etc/openvpn/client/easy-rsa/3.0.7/pki/easy-rsa-28830.1Uj5EB/tmp.PRmM3e&apos;
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &apos;.&apos;, the field will be left blank.
-----
Common Name (eg: your user, host, or server name) [test]: # &#x8FD9;&#x91CC;&#x76F4;&#x63A5;&#x56DE;&#x8F66;

Keypair and certificate request completed. Your files are:
req: /etc/openvpn/client/easy-rsa/3.0.7/pki/reqs/test.req
key: /etc/openvpn/client/easy-rsa/3.0.7/pki/private/test.key
</code></pre>
<h4 id="&#x6700;&#x540E;&#x7B7E;&#x7EA6;&#x5BA2;&#x6237;&#x7AEF;&#x8BC1;&#x4E66;">&#x6700;&#x540E;&#x7B7E;&#x7EA6;&#x5BA2;&#x6237;&#x7AEF;&#x8BC1;&#x4E66;</h4>
<pre><code class="lang-shell">[root@localhost 3.0.7]# cd /etc/openvpn/easy-rsa/3.0.7/
[root@localhost 3.0.7]# pwd
/etc/openvpn/easy-rsa/3.0.7
[root@localhost 3.0.7]# ./easyrsa import-req /etc/openvpn/client/easy-rsa/3.0.7/pki/reqs/test.req test

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017

The request has been successfully imported with a short name of: test
You may now use this name to perform signing operations on this request.

[root@localhost 3.0.7]# ./easyrsa sign client test

Note: using Easy-RSA configuration from: /etc/openvpn/easy-rsa/3.0.7/vars
Using SSL: openssl OpenSSL 1.0.2k-fips  26 Jan 2017


You are about to sign the following certificate.
Please check over the details shown below for accuracy. Note that this request
has not been cryptographically verified. Please be sure it came from a trusted
source or that you have verified the request checksum with the sender.

Request subject, to be signed as a client certificate for 825 days:

subject=
    commonName                = test


Type the word &apos;yes&apos; to continue, or any other input to abort.
  Confirm request details: yes    # &#x8FD9;&#x91CC;&#x8F93;&#x5165;yes
Using configuration from /etc/openvpn/easy-rsa/3.0.7/pki/easy-rsa-31692.OSZF1J/tmp.ogDbJ2
Check that the request matches the signature
Signature ok
The Subject&apos;s Distinguished Name is as follows
commonName            :ASN.1 12:&apos;test&apos;
Certificate is to be certified until Aug 31 07:38:51 2022 GMT (825 days)

Write out database with 1 new entries
Data Base Updated

Certificate created at: /etc/openvpn/easy-rsa/3.0.7/pki/issued/test.crt
</code></pre>
<h3 id="&#x6574;&#x7406;&#x8BC1;&#x4E66;">&#x6574;&#x7406;&#x8BC1;&#x4E66;</h3>
<p>&#x73B0;&#x5728;&#x6240;&#x6709;&#x7684;&#x8BC1;&#x4E66;&#x90FD;&#x5DF2;&#x7ECF;&#x751F;&#x6210;&#x5B8C;&#x4E86;&#xFF0C;&#x4E0B;&#x9762;&#x6765;&#x6574;&#x7406;&#x4E00;&#x4E0B;&#x3002;</p>
<h4 id="&#x670D;&#x52A1;&#x7AEF;&#x6240;&#x9700;&#x8981;&#x7684;&#x6587;&#x4EF6;">&#x670D;&#x52A1;&#x7AEF;&#x6240;&#x9700;&#x8981;&#x7684;&#x6587;&#x4EF6;</h4>
<pre><code class="lang-shell">[root@localhost ~]# mkdir /etc/openvpn/certs
[root@localhost ~]# cd /etc/openvpn/certs/  
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/dh.pem .        
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/ca.crt .
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/issued/server.crt .
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/private/server.key .
[root@localhost certs]# ll
total 20
-rw------- 1 root root 1172 May 28 15:56 ca.crt
-rw------- 1 root root  424 May 28 15:56 dh.pem
-rw------- 1 root root 4547 May 28 15:57 server.crt
-rw------- 1 root root 1704 May 28 15:57 server.key
</code></pre>
<h4 id="&#x5BA2;&#x6237;&#x7AEF;&#x6240;&#x9700;&#x7684;&#x6587;&#x4EF6;">&#x5BA2;&#x6237;&#x7AEF;&#x6240;&#x9700;&#x7684;&#x6587;&#x4EF6;</h4>
<pre><code class="lang-shell">[root@localhost certs]# mkdir /etc/openvpn/client/test/
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/ca.crt /etc/openvpn/client/test/
[root@localhost certs]# cp /etc/openvpn/easy-rsa/3.0.7/pki/issued/test.crt /etc/openvpn/client/test/
[root@localhost certs]# cp /etc/openvpn/client/easy-rsa/3.0.7/pki/private/test.key /etc/openvpn/client/test/
[root@localhost certs]# ll /etc/openvpn/client/test/
total 16
-rw------- 1 root root 1172 May 28 15:58 ca.crt
-rw------- 1 root root 4426 May 28 15:59 test.crt
-rw------- 1 root root 1704 May 28 15:59 test.key
</code></pre>
<p>&#x5176;&#x5B9E;&#x8FD9;&#x4E09;&#x4E2A;&#x6587;&#x4EF6;&#x5C31;&#x591F;&#x4E86;&#xFF0C;&#x4E4B;&#x524D;&#x5168;&#x4E0B;&#x8F7D;&#x4E0B;&#x6765;&#x662F;&#x56E0;&#x4E3A;&#x65B9;&#x4FBF;&#xFF0C;&#x7136;&#x800C;&#x8FD9;&#x6B21;&#x61D2;&#x5F97;&#x5F04;&#x4E86;&#xFF0C;&#x54C8;&#x54C8;&#xFF0C;&#x7F16;&#x5199;&#x670D;&#x52A1;&#x7AEF;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x3002;&#x987A;&#x4FBF;&#x63D0;&#x4E00;&#x4E0B;&#x518D;&#x6DFB;&#x52A0;&#x7528;&#x6237;&#x5728;<code>./easyrsa gen-req</code>&#x8FD9;&#x91CC;&#x5F00;&#x59CB;&#x5C31;&#x884C;&#x4E86;,&#x50CF;&#x662F;&#x540A;&#x9500;&#x7528;&#x6237;&#x8BC1;&#x4E66;&#x7684;&#x547D;&#x4EE4;&#x90FD;&#x81EA;&#x5DF1;&#x7528;<code>./easyrsa --help</code>&#x53BB;&#x770B;&#x5427;&#xFF0C;<a href="https://github.com/OpenVPN/easy-rsa/blob/v3.0.5/README.quickstart.md" target="_blank">GitHub</a>&#x9879;&#x76EE;&#x5730;&#x5740;</p>
<h3 id="&#x670D;&#x52A1;&#x5668;&#x914D;&#x7F6E;&#x6587;&#x4EF6;">&#x670D;&#x52A1;&#x5668;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h3>
<pre><code class="lang-shell">[root@localhost ~]# vim /etc/openvpn/server.conf
local 192.168.0.240       #&#x670D;&#x52A1;&#x5668;IP
port 1194                 #&#x5360;&#x7528;&#x7AEF;&#x53E3;
proto udp                 #&#x4F7F;&#x7528;udp&#x534F;&#x8BAE;
dev tun                   #&#x4F7F;&#x7528;tun&#x6A21;&#x5F0F;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;tap    &#x3002;     &quot;dev tun&quot;&#x5C06;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x8DEF;&#x7531;IP&#x96A7;&#x9053;&#xFF0C; &quot;dev tap&quot;&#x5C06;&#x4F1A;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x4EE5;&#x592A;&#x7F51;&#x96A7;&#x9053;

ca /etc/openvpn/certs/ca.crt
cert /etc/openvpn/certs/server.crt
key /etc/openvpn/certs/server.key
dh /etc/openvpn/certs/dh.pem                 #&#x6307;&#x5B9A;&#x8BC1;&#x4E66;&#x4F4D;&#x7F6E;

ifconfig-pool-persist /etc/openvpn/ipp.txt    #&#x5B58;&#x653E;&#x6BCF;&#x4E2A;&#x4EBA;&#x4F7F;&#x7528;&#x7684;IP

server 10.8.0.0 255.255.255.0                #&#x5BA2;&#x6237;&#x7AEF;DHCP&#x3002;        &#x5E2E;&#x52A9;&#x7A0B;&#x5E8F;&#x6307;&#x4EE4;&#xFF0C;&#x65E8;&#x5728;&#x7B80;&#x5316;OpenVPN&#x670D;&#x52A1;&#x5668;&#x6A21;&#x5F0F;&#x7684;&#x914D;&#x7F6E;&#x3002;&#x8BE5;&#x6307;&#x4EE4;&#x5C06;&#x8BBE;&#x7F6E;&#x4E00;&#x4E2A;OpenVPN&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x8BE5;&#x670D;&#x52A1;&#x5668;&#x5C06;&#x4E3A;&#x7ED9;&#x5B9A;&#x7F51;&#x7EDC;/&#x7F51;&#x7EDC;&#x63A9;&#x7801;&#x4E4B;&#x5916;&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x5206;&#x914D;&#x5730;&#x5740;&#x3002;&#x670D;&#x52A1;&#x5668;&#x672C;&#x8EAB;&#x5C06;&#x4F7F;&#x7528;&#x7ED9;&#x5B9A;&#x7F51;&#x7EDC;&#x7684;&#x201C; .1&#x201D;&#x5730;&#x5740;&#x4F5C;&#x4E3A;&#x672C;&#x5730;TUN / TAP&#x63A5;&#x53E3;&#x7684;&#x670D;&#x52A1;&#x5668;&#x7AEF;&#x7AEF;&#x70B9;&#x3002;
push &quot;route 192.168.0.0 255.255.255.0&quot;
push &quot;redirect-gateway def1 bypass-dhcp&quot;    #&#x6240;&#x6709;&#x6D41;&#x91CF;&#x90FD;&#x8D70;VPN&#xFF0C;&#x5982;&#x679C;&#x4E0D;&#x9700;&#x8981;&#x5C06;&#x4E0B;&#x4E09;&#x884C;&#x53BB;&#x6389;
push &quot;dhcp-option DNS 223.5.5.5&quot;            #DNS1
push &quot;dhcp-option DNS 223.6.6.6&quot;            #DNS2
client-to-client                            #&#x5141;&#x8BB8;&#x5BA2;&#x6237;&#x7AEF;&#x4E4B;&#x95F4;&#x4E92;&#x901A;

keepalive 20 120    #&#x4FDD;&#x6301;&#x8FDE;&#x63A5;&#x65F6;&#x95F4;
comp-lzo            #&#x5F00;&#x542F;vpn&#x538B;&#x7F29;
#duplicate-cn        #&#x5141;&#x8BB8;&#x591A;&#x4EBA;&#x4F7F;&#x7528;&#x540C;&#x4E00;&#x4E2A;&#x8BC1;&#x4E66;&#x8FDE;&#x63A5;VPN&#xFF0C;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#xFF0C;&#x6CE8;&#x91CA;&#x72B6;&#x6001;

user openvpn        #&#x8FD0;&#x884C;&#x7528;&#x6237;
group openvpn        #&#x8FD0;&#x884C;&#x7EC4;

persist-key                               
persist-tun
status openvpn-status.log    
log-append  openvpn.log     
verb 1                #&#x65E5;&#x5FD7;&#x7EA7;&#x522B;0-9&#xFF0C;&#x7B49;&#x7EA7;&#x8D8A;&#x9AD8;&#xFF0C;&#x8BB0;&#x5F55;&#x8D8A;&#x591A;
mute 20
</code></pre>
<p><img src="image/image-20200528164909819.png" alt="image-20200528164909819"></p>
<p><img src="image/image-20200528164957689.png" alt="image-20200528164957689"></p>
<p><img src="image/image-20200528165031352.png" alt="image-20200528165031352"></p>
<h3 id="&#x542F;&#x52A8;&#x670D;&#x52A1;">&#x542F;&#x52A8;&#x670D;&#x52A1;</h3>
<pre><code class="lang-shell">[root@localhost ~]# systemctl start openvpn@server
[root@localhost ~]# systemctl enable openvpn@server        # &#x5F00;&#x673A;&#x542F;&#x52A8;
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="yapi教程.html" class="navigation navigation-prev " aria-label="Previous page: yapi教程">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="服务器安装.html" class="navigation navigation-next " aria-label="Next page: 服务器安装">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"搭建vpn","level":"1.19","depth":1,"next":{"title":"服务器安装","level":"1.20","depth":1,"path":"服务器安装.md","ref":"服务器安装.md","articles":[]},"previous":{"title":"yapi教程","level":"1.18","depth":1,"path":"yapi教程.md","ref":"yapi教程.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"搭建vpn.md","mtime":"2020-05-28T10:09:21.038Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-06-19T10:01:14.073Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

